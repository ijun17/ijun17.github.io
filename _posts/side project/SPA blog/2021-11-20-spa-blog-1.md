---
layout: post
title: "jekyll로 SPA 블로그 만들기"
category: "SPA-blog"
---
## 블로그 소개
내가 개발을 하면서 있었던 일들을 기록하고 싶어서 이 블로그를 만들었다. 호스팅 장소는 github page로 정했다. 포스트의 빠른 로딩과 다른 페이지로 이동시 네비게이션바 새로고침을 막기위해 SPA(Single Page Application)로 개발을 하였으며, SPA의 단점을 보완하기 위해 jekyll을 이용했다. jekyll은 github page에서 지원하는 정적사이트 생성기이다. 

내가 원하는 블로그의 요구사항은 다음과 같다.
* 빠른 속도와 네비게이션바 새로고침을 막기위해 SPA로 개발
* 네비게이션바만으로 원하는 모든 포스트에 접근할 수 있다
* 포스트를 마크다운 파일로 작성

## SPA
`SPA(Single Page Application)`란 하나의 페이지에서 새로운 정보를 불러올때 다른 페이지로 이동하지 않고 필요한 정보만 동적으로 가져오는 웹이다. 포스트 내용만 새로 로딩하기 때문에 네비게이션바가 새로고침되지 않고 속도도 빠르다. 

SPA를 구현하기 위해서는 자바스크립트가 필요하다. SPA를 쉽게 구현하기 위한 다양한 프레임워크가 있지만, 나는 그렇게 복잡한 기능을 구현하는것은 아니기 때문에 바닐라 자바스크립트로 SPA를 구현했다. 다음은 dynamic.js의 코드이다.

```js
const html_post=document.querySelector(".post");

let xmlHttp = new XMLHttpRequest();
xmlHttp.onreadystatechange = function () {
    if (this.status == 200 && this.readyState == this.DONE) setPost(this.responseText);
};

//포스트를 서버에 요청
function loadPost(url, historyPush=true){
    if (url === document.location.pathname) return;
    xmlHttp.open("GET", url, true);
    xmlHttp.send();
    if(historyPush)history.pushState(null, null, url);
}

//포스트 로드가 완료되면 실행되는 함수
function setPost(text){
    text.replace(/<!--post start-->(.*)<!--post end-->/s,function(match,p1){html_post.innerHTML=p1;})
}

//특정 클래스를 포함한 엘레멘트를 클릭시 loadPost 메소드 실행
document.addEventListener("click", function (event) {
    if (event.target.classList.contains("dynamic-post")) loadPost(event.target.dataset.url, true);
})

//페이지 이전 혹은 이후로 갈때 loadPost 메소드 실행
window.onpopstate = function(){loadPost(document.location, false);};
``` 

하지만 SPA는 검색엔진 최적화가 어렵다는 단점이 있다. 검색엔진 최적화란 웹사이트가 검색이 잘되게 하는 것이다. 검색엔진은 먼저 웹사이트에 무슨 내용이 있는지 접속하는데, 문제는 검색엔진은 자바스크립트를 실행시키지 않는다는 것이다. SPA는 자바스크립트로 구현되기 때문에 검색엔진이 접속한 SPA 웹사이트는 빈 화면만 뜨게 된다. 이를 해결하기 위해 SSR(Server Side Rendering)이란 기술이 있다. SSR이란 웹사이트에 접속을 할때 서버에서 미리 자바스크립트로 페이지를 완성하고 클라이언트에게 주는 것이다. 이것과 비슷한 기능을 하는것이 SSG(정적 사이트 생성기)이다. 그리고 jekyll은 정적 사이트 생성기 중 하나이다. jekyll을 사용하면 또한 마크다운을 html으로 자동 변환해주는 기능이 있다. 

## jekyll
`jekyll`은 정적 사이트 생성기